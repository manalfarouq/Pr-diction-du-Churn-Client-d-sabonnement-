import pytest
import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.datasets import load_iris


def prepare_data(test_size=0.2, random_state=42):
    
    # Charge le dataset Iris et effectue le split train 
    iris = load_iris()
    X = pd.DataFrame(iris.data, columns=iris.feature_names)  
    y = pd.Series(iris.target)  
    
    X_train, X_test, y_train, y_test = train_test_split(
        X, y, test_size=test_size, random_state=random_state
    )
    return X, X_train, X_test, y, y_train, y_test



def test_split_dimensions():
    # Récupérer les données split
    X, X_train, X_test, y, y_train, y_test = prepare_data()
    
    # 1. X_train et y_train ont le même nombre de lignes
    assert X_train.shape[0] == y_train.shape[0]
    
    # 2. X_test et y_test ont le même nombre de lignes
    assert X_test.shape[0] == y_test.shape[0]
    
    # 3. Somme des lignes = lignes totales
    assert X_train.shape[0] + X_test.shape[0] == X.shape[0]
    assert y_train.shape[0] + y_test.shape[0] == y.shape[0]
    
    # 4. X_train et X_test ont le même nombre de colonnes que X
    assert X_train.shape[1] == X.shape[1]
    assert X_test.shape[1] == X.shape[1]
